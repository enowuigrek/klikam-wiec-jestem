let clickCount = 0;
let bonusAmount = 0;
let prestigeLevel = 0;
let playerName = '';
const button = document.getElementById('zdkButton');
const countDisplay = document.getElementById('clickCount');
const bonusDisplay = document.getElementById('bonusAmount');
const prestigeDisplay = document.getElementById('prestigeLevel');
const titleScreen = document.getElementById('titleScreen');
const startButton = document.getElementById('startButton');
const playerNameInput = document.getElementById('playerNameInput');
const windowEl = document.getElementById('window');<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="ZDK - Klikam wiƒôc jestem">
    <meta name="theme-color" content="#1a1a2e">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://klikam-wiec-jestem.netlify.app/">
    <meta property="og:title" content="ZDK - Klikam wiƒôc jestem">
    <meta property="og:description" content="üéÆ Symulator polskiego pracownika. Klikaj, zdobywaj premie, awansuj... i odkryj prawdƒô o podatkach! üí∞‚ö°">
    <meta property="og:image" content="https://klikam-wiec-jestem.netlify.app/og-image.png">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://klikam-wiec-jestem.netlify.app/">
    <meta property="twitter:title" content="ZDK - Klikam wiƒôc jestem">
    <meta property="twitter:description" content="üéÆ Symulator polskiego pracownika. Klikaj, zdobywaj premie, awansuj... i odkryj prawdƒô o podatkach! üí∞‚ö°">
    <meta property="twitter:image" content="https://klikam-wiec-jestem.netlify.app/og-image.png">

    <!-- Favicons -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' fill='%23ff6b6b'/%3E%3Ctext x='50' y='70' font-size='50' text-anchor='middle' fill='white' font-family='Arial' font-weight='bold'%3EZDK%3C/text%3E%3C/svg%3E">
    <link rel="apple-touch-icon" href="icon-192.png">
    <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIlpESyAtIEtsaWthbSB3acSZYyBqZXN0ZW0iLAogICJzaG9ydF9uYW1lIjogIlpESyIsCiAgImRlc2NyaXB0aW9uIjogIlN5bXVsYXRvciBwb2xza2llZ28gcHJhY293bmlrYSIsCiAgImRpc3BsYXkiOiAic3RhbmRhbG9uZSIsCiAgInN0YXJ0X3VybCI6ICIuIiwKICAiYmFja2dyb3VuZF9jb2xvciI6ICIjMWExYTJlIiwKICAidGhlbWVfY29sb3IiOiAiIzFhMWEyZSIsCiAgImljb25zIjogW3sKICAgICJzcmMiOiAiaWNvbi0xOTIucG5nIiwKICAgICJzaXplcyI6ICIxOTJ4MTkyIiwKICAgICJ0eXBlIjogImltYWdlL3BuZyIKICB9XQp9">
    <title>ZDK - Klikam wiƒôc jestem</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            overflow: hidden;
            height: 100vh;
            width: 100vw;
            position: relative;
            image-rendering: pixelated;
            image-rendering: crisp-edges;
        }

        /* Ekran tytu≈Çowy */
        #titleScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: opacity 0.5s;
        }

        #titleScreen.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .title {
            font-size: 52px;
            color: #fff;
            text-shadow: 4px 4px 0px rgba(0,0,0,0.3), 8px 8px 0px rgba(0,0,0,0.1);
            margin-bottom: 60px;
            text-align: center;
            padding: 0 20px;
            line-height: 1.3;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        #startButton {
            padding: 20px 50px;
            font-size: 28px;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            color: #fff;
            background: #ff6b6b;
            border: 4px solid #c92a2a;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 6px 0 #c92a2a, 0 10px 30px rgba(0,0,0,0.3);
            position: relative;
        }

        #startButton:hover {
            background: #ff8787;
            transform: translateY(-2px);
            box-shadow: 0 8px 0 #c92a2a, 0 12px 35px rgba(0,0,0,0.4);
        }

        #startButton:active {
            transform: translateY(2px);
            box-shadow: 0 3px 0 #c92a2a, 0 5px 15px rgba(0,0,0,0.3);
        }

        .install-hint {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 11px;
            color: rgba(255,255,255,0.6);
            text-align: center;
            max-width: 300px;
            line-height: 1.5;
        }

        /* Formularz imienia */
        .name-input-container {
            margin-bottom: 40px;
            text-align: center;
        }

        .name-input-label {
            font-size: 16px;
            color: rgba(255,255,255,0.9);
            margin-bottom: 10px;
            display: block;
        }

        #playerNameInput {
            padding: 12px 20px;
            font-size: 18px;
            font-family: 'Courier New', monospace;
            background: rgba(255,255,255,0.1);
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 10px;
            color: white;
            text-align: center;
            width: 250px;
            max-width: 80%;
            transition: all 0.3s;
        }

        #playerNameInput:focus {
            outline: none;
            border-color: #00ff88;
            background: rgba(255,255,255,0.15);
            box-shadow: 0 0 20px rgba(0,255,136,0.3);
        }

        #playerNameInput::placeholder {
            color: rgba(255,255,255,0.5);
        }

        /* T≈Ço gry - pok√≥j */
        #gameBackground {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            transition: background 2s ease;
        }

        .office {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .wall {
            position: absolute;
            bottom: 20%;
            left: 0;
            width: 100%;
            height: 80%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            transition: all 2s ease;
            z-index: 1;
        }

        .floor {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 20%;
            background: repeating-linear-gradient(
                    90deg,
                    #2d3748 0px,
                    #2d3748 50px,
                    #374151 50px,
                    #374151 100px
            );
            transition: all 2s ease;
            z-index: 2;
        }

        /* ≈öwiat≈Ço z okna */
        .window-light {
            position: absolute;
            top: 10%;
            right: 8%;
            width: 500px;
            height: 500px;
            background: radial-gradient(ellipse at top, rgba(255,255,255,0.4) 0%, rgba(255,255,255,0.2) 30%, rgba(255,255,255,0.05) 50%, transparent 70%);
            pointer-events: none;
            transition: all 2s ease;
            filter: blur(60px);
            z-index: 5;
            transform: rotate(-20deg);
        }

        /* Okno z widokiem */
        .window {
            position: absolute;
            top: 15%;
            right: 10%;
            width: 280px;
            height: 250px;
            background: #87ceeb;
            border: 14px solid #2d3748;
            box-shadow: inset 0 0 40px rgba(0,0,0,0.3), 0 15px 50px rgba(0,0,0,0.5);
            transition: background 2s ease;
            border-radius: 6px;
            z-index: 3;
        }

        .window-frame {
            position: absolute;
            width: 100%;
            height: 5px;
            background: #1a202c;
            top: 50%;
            transform: translateY(-50%);
            z-index: 10;
        }

        .window-frame-v {
            position: absolute;
            width: 5px;
            height: 100%;
            background: #1a202c;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
        }

        /* S≈Ço≈Ñce/Ksiƒô≈ºyc w oknie */
        .celestial {
            position: absolute;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            top: 30%;
            right: 20%;
            transition: all 2s ease;
            z-index: 1;
        }

        /* Lampka */
        .lamp {
            position: absolute;
            top: 12%;
            left: 12%;
            width: 80px;
            height: 120px;
            z-index: 4;
        }

        .lamp-cord {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 3px;
            height: 35px;
            background: #2d2d2d;
        }

        .lamp-shade {
            position: absolute;
            top: 35px;
            left: 50%;
            transform: translateX(-50%);
            width: 65px;
            height: 45px;
            background: linear-gradient(to bottom, #ffd700 0%, #ffed4e 100%);
            border-radius: 0 0 22px 22px;
            border: 4px solid #d4af37;
            transition: all 2s ease;
            box-shadow: 0 10px 30px rgba(255,215,0,0.5);
        }

        .lamp-shade.off {
            background: linear-gradient(to bottom, #888 0%, #666 100%);
            border-color: #555;
            box-shadow: none;
        }

        .lamp-light {
            position: absolute;
            top: 80px;
            left: 50%;
            transform: translateX(-50%);
            width: 140px;
            height: 120px;
            background: radial-gradient(ellipse at top, rgba(255,235,59,0.4) 0%, rgba(255,235,59,0.2) 40%, transparent 70%);
            pointer-events: none;
            filter: blur(20px);
            opacity: 1;
            transition: opacity 2s ease;
        }

        .lamp-light.off {
            opacity: 0;
        }

        /* UI */
        #uiContainer {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 100;
            display: flex;
            flex-direction: row;
            gap: 15px;
            flex-wrap: wrap;
            pointer-events: none;
            max-width: calc(100% - 40px);
        }

        .ui-box {
            background: rgba(0,0,0,0.8);
            padding: 12px 20px;
            border-radius: 12px;
            border: 3px solid #00ff88;
            box-shadow: 0 4px 20px rgba(0,255,136,0.3);
            color: white;
            font-size: 18px;
            pointer-events: auto;
        }

        .ui-box.bonus {
            border-color: #ffd700;
            box-shadow: 0 4px 20px rgba(255,215,0,0.3);
        }

        .ui-label {
            font-size: 12px;
            opacity: 0.8;
            margin-bottom: 3px;
        }

        .ui-value {
            font-size: 24px;
            font-weight: bold;
            color: #00ff88;
        }

        .ui-value.bonus {
            color: #ffd700;
        }

        /* Przyciski akcji */
        #actionButtons {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            z-index: 100;
            padding: 0 15px;
            max-width: 450px;
            width: calc(100% - 30px);
            box-sizing: border-box;
        }

        .action-btn {
            padding: 14px 16px;
            font-size: 14px;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            color: white;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: 3px solid #4a5fbb;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 4px 15px rgba(102,126,234,0.4);
            white-space: nowrap;
            text-align: center;
            overflow: hidden;
            text-overflow: ellipsis;
            min-width: 0;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102,126,234,0.6);
        }

        .action-btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 10px rgba(102,126,234,0.4);
        }

        .action-btn.withdraw {
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            border-color: #d4af37;
            color: #333;
            box-shadow: 0 4px 15px rgba(255,215,0,0.4);
        }

        .action-btn.withdraw:hover {
            box-shadow: 0 6px 20px rgba(255,215,0,0.6);
        }

        .action-btn.achievements {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-color: #c73866;
            box-shadow: 0 4px 15px rgba(240,147,251,0.4);
        }

        .action-btn.achievements:hover {
            box-shadow: 0 6px 20px rgba(240,147,251,0.6);
        }

        .action-btn.prestige {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-color: #4a5fbb;
            box-shadow: 0 4px 15px rgba(102,126,234,0.4);
        }

        .action-btn.prestige:hover {
            box-shadow: 0 6px 20px rgba(102,126,234,0.6);
        }

        .action-btn.prestige:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .action-btn.help {
            position: fixed;
            bottom: 250px;
            left: 30px;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            border-color: #047857;
            box-shadow: 0 4px 15px rgba(16,185,129,0.4);
            font-size: 20px;
            padding: 12px 16px;
            width: auto;
            min-width: auto;
            z-index: 150;
        }

        .action-btn.help:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 6px 20px rgba(16,185,129,0.6);
        }

        .action-btn.help:hover {
            box-shadow: 0 6px 20px rgba(16,185,129,0.6);
        }

        /* Panel osiƒÖgniƒôƒá */
        #achievementsPanel {
            position: fixed;
            top: 0;
            right: -350px;
            width: 320px;
            height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 500;
            transition: right 0.3s;
            overflow-y: auto;
            padding: 20px;
            border-left: 4px solid #f093fb;
        }

        #achievementsPanel.open {
            right: 0;
        }

        .achievements-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f093fb;
        }

        .achievements-title {
            font-size: 24px;
            color: #f093fb;
            font-weight: bold;
        }

        .close-achievements {
            background: none;
            border: none;
            color: white;
            font-size: 28px;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            line-height: 1;
        }

        .achievement-item {
            background: rgba(255,255,255,0.05);
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 10px;
            border: 2px solid rgba(240,147,251,0.3);
            transition: all 0.2s;
        }

        .achievement-item.unlocked {
            border-color: #f093fb;
            background: rgba(240,147,251,0.1);
            animation: unlock 0.5s;
        }

        @keyframes unlock {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .achievement-icon {
            font-size: 32px;
            margin-bottom: 8px;
            filter: grayscale(100%);
        }

        .achievement-item.unlocked .achievement-icon {
            filter: grayscale(0%);
        }

        .achievement-name {
            font-size: 16px;
            color: white;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .achievement-desc {
            font-size: 13px;
            color: rgba(255,255,255,0.7);
            margin-bottom: 5px;
        }

        .achievement-progress {
            font-size: 12px;
            color: #f093fb;
            opacity: 0.8;
        }

        /* Notyfikacja osiƒÖgniƒôcia */
        #achievementNotification {
            position: fixed;
            top: 100px;
            right: -400px;
            width: 300px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            padding: 20px;
            border-radius: 15px;
            z-index: 1000;
            transition: right 0.5s;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
            border: 3px solid #fff;
        }

        #achievementNotification.show {
            right: 20px;
        }

        .achievement-notif-title {
            font-size: 14px;
            color: rgba(255,255,255,0.9);
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .achievement-notif-name {
            font-size: 20px;
            color: white;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .achievement-notif-icon {
            font-size: 48px;
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
        }

        /* Modal */
        #modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.85);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            animation: fadeIn 0.3s;
            padding: 20px;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        #modal.show {
            display: flex;
        }

        .modal-content {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            padding: 40px;
            border-radius: 20px;
            border: 4px solid #ff6b6b;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            text-align: center;
            animation: slideUp 0.3s;
            box-shadow: 0 20px 60px rgba(0,0,0,0.8);
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-title {
            font-size: 28px;
            color: #ff6b6b;
            margin-bottom: 20px;
        }

        .modal-text {
            font-size: 16px;
            color: #fff;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .modal-btn {
            padding: 15px 40px;
            font-size: 20px;
            font-family: 'Courier New', monospace;
            background: #ff6b6b;
            color: white;
            border: 3px solid #c92a2a;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .modal-btn:hover {
            background: #ff8787;
            transform: scale(1.05);
        }

        /* Przycisk ZDK */
        #zdkButton {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            padding: 25px 50px;
            font-size: 32px;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            color: white;
            background: linear-gradient(135deg, #ff6b6b 0%, #ff5252 100%);
            border: 5px solid #c92a2a;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 50;
            box-shadow: 0 8px 0 #c92a2a, 0 12px 40px rgba(255,107,107,0.6);
        }

        #zdkButton:hover {
            background: linear-gradient(135deg, #ff8787 0%, #ff6b6b 100%);
            transform: translate(-50%, -50%) scale(1.05);
        }

        #zdkButton:active {
            transform: translate(-50%, -48%) scale(0.95);
            box-shadow: 0 4px 0 #c92a2a, 0 6px 20px rgba(255,107,107,0.5);
        }

        @media (max-width: 768px) {
            .title { font-size: 36px; }
            .ui-box { font-size: 14px; padding: 10px 16px; }
            .ui-value { font-size: 20px; }
            .ui-label { font-size: 11px; }
            .window { width: 180px; height: 160px; right: 5%; top: 12%; }
            .celestial { width: 35px; height: 35px; }
            .action-btn { font-size: 13px; padding: 12px 12px; }
            .action-btn.help { font-size: 18px; padding: 10px 14px; bottom: 180px; left: 20px; }
            #actionButtons { max-width: 100%; gap: 8px; bottom: 10px; padding: 0 10px; width: calc(100% - 20px); }
            #zdkButton { font-size: 26px; padding: 20px 40px; }
            .window-light { width: 350px; height: 350px; }
            .lamp { left: 10%; top: 10%; transform: scale(0.7); }
            #achievementsPanel { width: 100%; right: -100%; }
            .install-hint { font-size: 10px; max-width: 250px; }
            #uiContainer { top: 10px; left: 10px; gap: 8px; }
            .modal-content { padding: 30px 20px; max-width: 95%; }
            .modal-text { font-size: 14px; }
        } right: 5%; top: 12%; }
        .celestial { width: 35px; height: 35px; }
        .action-btn { font-size: 13px; padding: 12px 12px; }
        .action-btn.help { font-size: 12px; padding: 10px 12px; }
        #actionButtons { max-width: 100%; gap: 8px; bottom: 10px; padding: 0 10px; width: calc(100% - 20px); }
        #zdkButton { font-size: 26px; padding: 20px 40px; }
        .window-light { width: 350px; height: 350px; }
        .lamp { left: 10%; top: 10%; transform: scale(0.7); }
        #achievementsPanel { width: 100%; right: -100%; }
        .install-hint { font-size: 10px; max-width: 250px; }
        #uiContainer { top: 10px; left: 10px; gap: 8px; }
        .modal-content { padding: 30px 20px; max-width: 95%; }
        .modal-text { font-size: 14px; }
        }
    </style>
</head>
<body>
<!-- Ekran tytu≈Çowy -->
<div id="titleScreen">
    <div class="title">KLIKAM<br>WIƒòC<br>JESTEM</div>
    <div class="name-input-container">
        <label class="name-input-label" for="playerNameInput">Jak siƒô nazywasz?</label>
        <input type="text" id="playerNameInput" placeholder="Twoje imiƒô" maxlength="20">
    </div>
    <button id="startButton">KLIK</button>
    <div class="install-hint">
        üí° Dodaj do ekranu g≈Ç√≥wnego telefonu:<br>
        Menu ‚Üí "Dodaj do ekranu g≈Ç√≥wnego"
    </div>
</div>

<!-- T≈Ço gry -->
<div id="gameBackground">
    <div class="office">
        <div class="wall"></div>
        <div class="floor"></div>

        <!-- Okno z widokiem -->
        <div class="window" id="window">
            <div class="celestial" id="celestial"></div>
            <div class="window-frame"></div>
            <div class="window-frame-v"></div>
        </div>

        <!-- ≈öwiat≈Ço z okna -->
        <div class="window-light" id="windowLight"></div>

        <!-- Lampka -->
        <div class="lamp">
            <div class="lamp-cord"></div>
            <div class="lamp-shade" id="lampShade"></div>
            <div class="lamp-light" id="lampLight"></div>
        </div>
    </div>
</div>

<!-- UI -->
<div id="uiContainer">
    <div class="ui-box">
        <div class="ui-label">Klikniƒôcia</div>
        <div class="ui-value"><span id="clickCount">0</span></div>
    </div>
    <div class="ui-box bonus">
        <div class="ui-label">Premia</div>
        <div class="ui-value bonus"><span id="bonusAmount">0.00</span> z≈Ç</div>
    </div>
    <div class="ui-box" style="border-color: #667eea; box-shadow: 0 4px 20px rgba(102,126,234,0.3);">
        <div class="ui-label">Prestige</div>
        <div class="ui-value" style="color: #667eea;"><span id="prestigeLevel">0</span></div>
    </div>
</div>

<!-- Przyciski akcji -->
<div id="actionButtons">
    <button class="action-btn withdraw" id="withdrawBtn">üí∞ Wyp≈Çaƒá</button>
    <button class="action-btn" id="shareBtn">üì§ Udostƒôpnij</button>
    <button class="action-btn achievements" id="achievementsBtn">üèÜ OsiƒÖgniƒôcia</button>
    <button class="action-btn prestige" id="prestigeBtn" disabled>‚≠ê (10000)</button>
</div>

<!-- Przycisk help w prawym g√≥rnym rogu -->
<button class="action-btn help" id="helpBtn">‚ùì</button>

<!-- Przycisk ZDK -->
<button id="zdkButton">ZDK</button>

<!-- Modal -->
<div id="modal">
    <div class="modal-content">
        <div class="modal-title" id="modalTitle">Wyp≈Çata premii</div>
        <div class="modal-text" id="modalText"></div>
        <button class="modal-btn" id="modalClose">Rozumiem üò¢</button>
    </div>
</div>

<!-- Panel osiƒÖgniƒôƒá -->
<div id="achievementsPanel">
    <div class="achievements-header">
        <div class="achievements-title">üèÜ OsiƒÖgniƒôcia</div>
        <button class="close-achievements" id="closeAchievements">√ó</button>
    </div>
    <div id="achievementsList"></div>
</div>

<!-- Notyfikacja osiƒÖgniƒôcia -->
<div id="achievementNotification">
    <div class="achievement-notif-title">üéâ OsiƒÖgniƒôcie Odblokowane!</div>
    <div class="achievement-notif-name" id="notifAchievementName"></div>
    <div class="achievement-notif-icon" id="notifAchievementIcon"></div>
</div>

<script>
    let clickCount = 0;
    let bonusAmount = 0;
    let prestigeLevel = 0;
    const button = document.getElementById('zdkButton');
    const countDisplay = document.getElementById('clickCount');
    const bonusDisplay = document.getElementById('bonusAmount');
    const prestigeDisplay = document.getElementById('prestigeLevel');
    const titleScreen = document.getElementById('titleScreen');
    const startButton = document.getElementById('startButton');
    const windowEl = document.getElementById('window');
    const celestial = document.getElementById('celestial');
    const windowLight = document.getElementById('windowLight');
    const lampShade = document.getElementById('lampShade');
    const lampLight = document.getElementById('lampLight');
    const withdrawBtn = document.getElementById('withdrawBtn');
    const shareBtn = document.getElementById('shareBtn');
    const achievementsBtn = document.getElementById('achievementsBtn');
    const prestigeBtn = document.getElementById('prestigeBtn');
    const helpBtn = document.getElementById('helpBtn');
    const achievementsPanel = document.getElementById('achievementsPanel');
    const closeAchievements = document.getElementById('closeAchievements');
    const achievementsList = document.getElementById('achievementsList');
    const achievementNotification = document.getElementById('achievementNotification');
    const notifAchievementName = document.getElementById('notifAchievementName');
    const notifAchievementIcon = document.getElementById('notifAchievementIcon');
    const modal = document.getElementById('modal');
    const modalTitle = document.getElementById('modalTitle');
    const modalText = document.getElementById('modalText');
    const modalClose = document.getElementById('modalClose');

    // Achievements
    const achievements = [
        { id: 'first', name: 'Pierwszy krok', desc: 'Kliknij pierwszy raz', icon: 'üë∂', threshold: 1 },
        { id: 'novice', name: 'Nowicjusz', desc: 'Kliknij 50 razy', icon: 'üî∞', threshold: 50 },
        { id: 'worker', name: 'Pracowity', desc: 'Kliknij 100 razy', icon: 'üíº', threshold: 100 },
        { id: 'dedicated', name: 'Oddany', desc: 'Kliknij 250 razy', icon: 'üéØ', threshold: 250 },
        { id: 'expert', name: 'Ekspert', desc: 'Kliknij 500 razy', icon: '‚≠ê', threshold: 500 },
        { id: 'slave', name: 'Klikalny niewolnik', desc: 'Kliknij 1000 razy', icon: '‚õìÔ∏è', threshold: 1000 },
        { id: 'addict', name: 'Uzale≈ºniony', desc: 'Kliknij 2500 razy', icon: 'üî•', threshold: 2500 },
        { id: 'legend', name: 'Legenda', desc: 'Kliknij 5000 razy', icon: 'üëë', threshold: 5000 },
        { id: 'god', name: 'B√≥g Klikania', desc: 'Kliknij 10000 razy', icon: 'üåü', threshold: 10000 },
        { id: 'bonus1', name: 'Pierwsza premia', desc: 'ZdobƒÖd≈∫ pierwszƒÖ premiƒô', icon: 'üí∞', threshold: 100 },
        { id: 'bonus5', name: 'Gie≈Çdowy gracz', desc: 'ZdobƒÖd≈∫ 10 z≈Ç premii', icon: 'üíµ', bonusThreshold: 10 },
        { id: 'bonus10', name: 'Kapita≈Ç', desc: 'ZdobƒÖd≈∫ 50 z≈Ç premii', icon: 'üí∏', bonusThreshold: 50 },
        { id: 'bonus20', name: 'Bogacz', desc: 'ZdobƒÖd≈∫ 100 z≈Ç premii', icon: 'üíé', bonusThreshold: 100 },
        { id: 'timetravel', name: 'Podr√≥≈ºnik w czasie', desc: 'Zobacz wszystkie pory dnia', icon: '‚è∞', timesThreshold: 7 },
        { id: 'speedster', name: 'Mistrz klikania', desc: 'OsiƒÖgnij poziom 10 szybko≈õci', icon: '‚ö°', speedThreshold: 10 },
        { id: 'prestige1', name: 'Reinkarnacja', desc: 'Wykonaj pierwszy Prestige', icon: 'üîÑ', prestigeThreshold: 1 },
        { id: 'prestige5', name: 'O≈õwiecony', desc: 'Wykonaj 5 Prestige', icon: '‚ú®', prestigeThreshold: 5 }
    ];

    let unlockedAchievements = new Set();
    let seenTimes = new Set();
    let buttonSpeed = 1;

    function getPrestigeMultiplier() {
        return 1 + (prestigeLevel * 0.1);
    }

    const audioContext = new (window.AudioContext || window.webkitAudioContext)();

    function playClickSound() {
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();
        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);
        oscillator.frequency.value = 800;
        oscillator.type = 'sine';
        gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + 0.1);
    }

    function playAchievementSound() {
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();
        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);
        oscillator.type = 'triangle';
        gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
        oscillator.frequency.setValueAtTime(523.25, audioContext.currentTime);
        oscillator.frequency.setValueAtTime(659.25, audioContext.currentTime + 0.1);
        oscillator.frequency.setValueAtTime(783.99, audioContext.currentTime + 0.2);
        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + 0.5);
    }

    const timesOfDay = [
        { sky: '#ffa07a', celestialColor: '#ffd700', celestialTop: '70%', wall: 'linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #feada6 100%)', floor: 'repeating-linear-gradient(90deg, #3d2f2f 0px, #3d2f2f 50px, #4a3535 50px, #4a3535 100px)', lightColor: 'rgba(255,160,122,0.5)', lightIntensity: '0%, rgba(255,160,122,0.3) 25%, rgba(255,160,122,0.1) 45%' },
        { sky: '#87ceeb', celestialColor: '#ffeb3b', celestialTop: '45%', wall: 'linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)', floor: 'repeating-linear-gradient(90deg, #2d3748 0px, #2d3748 50px, #374151 50px, #374151 100px)', lightColor: 'rgba(255,235,59,0.6)', lightIntensity: '0%, rgba(255,235,59,0.4) 25%, rgba(255,235,59,0.15) 45%' },
        { sky: '#5dade2', celestialColor: '#ffeb3b', celestialTop: '15%', wall: 'linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%)', floor: 'repeating-linear-gradient(90deg, #2d3748 0px, #2d3748 50px, #374151 50px, #374151 100px)', lightColor: 'rgba(255,255,255,0.7)', lightIntensity: '0%, rgba(255,255,255,0.5) 25%, rgba(255,255,255,0.2) 45%' },
        { sky: '#f39c12', celestialColor: '#ffa500', celestialTop: '40%', wall: 'linear-gradient(135deg, #fa709a 0%, #fee140 100%)', floor: 'repeating-linear-gradient(90deg, #3d3020 0px, #3d3020 50px, #4a3828 50px, #4a3828 100px)', lightColor: 'rgba(255,165,0,0.6)', lightIntensity: '0%, rgba(255,165,0,0.4) 25%, rgba(255,165,0,0.15) 45%' },
        { sky: '#e67e22', celestialColor: '#ff6347', celestialTop: '65%', wall: 'linear-gradient(135deg, #ff9a9e 0%, #fad0c4 50%, #ffecd2 100%)', floor: 'repeating-linear-gradient(90deg, #3d2820 0px, #3d2820 50px, #4a3028 50px, #4a3028 100px)', lightColor: 'rgba(230,126,34,0.5)', lightIntensity: '0%, rgba(230,126,34,0.3) 25%, rgba(230,126,34,0.1) 45%' },
        { sky: '#34495e', celestialColor: '#bdc3c7', celestialTop: '30%', wall: 'linear-gradient(135deg, #4e54c8 0%, #8f94fb 100%)', floor: 'repeating-linear-gradient(90deg, #1a1f2e 0px, #1a1f2e 50px, #22283a 50px, #22283a 100px)', lightColor: 'rgba(189,195,199,0.3)', lightIntensity: '0%, rgba(189,195,199,0.2) 25%, rgba(189,195,199,0.08) 45%' },
        { sky: '#1a1a2e', celestialColor: '#f0e68c', celestialTop: '20%', wall: 'linear-gradient(135deg, #2c3e50 0%, #3498db 50%, #2c3e50 100%)', floor: 'repeating-linear-gradient(90deg, #0f1419 0px, #0f1419 50px, #151a20 50px, #151a20 100px)', lightColor: 'rgba(240,230,140,0.2)', lightIntensity: '0%, rgba(240,230,140,0.12) 25%, rgba(240,230,140,0.05) 45%' }
    ];

    let currentTimeIndex = 0;

    function loadGame() {
        const saved = localStorage.getItem('zdkGameState');
        if (saved) {
            const state = JSON.parse(saved);
            clickCount = state.clicks || 0;
            bonusAmount = state.bonus || 0;
            prestigeLevel = state.prestige || 0;
            currentTimeIndex = state.timeIndex || 0;
            buttonSpeed = state.speed || 1;
            playerName = state.playerName || '';
            unlockedAchievements = new Set(state.achievements || []);
            seenTimes = new Set(state.seenTimes || []);
            countDisplay.textContent = clickCount;
            bonusDisplay.textContent = bonusAmount.toFixed(2);
            prestigeDisplay.textContent = prestigeLevel;
            if (playerName) {
                playerNameInput.value = playerName;
            }
            updateTimeOfDay();
            updateAchievementsList();
            updatePrestigeButton();
        }
    }

    function saveGame() {
        const state = {
            clicks: clickCount,
            bonus: bonusAmount,
            prestige: prestigeLevel,
            timeIndex: currentTimeIndex,
            speed: buttonSpeed,
            playerName: playerName,
            achievements: Array.from(unlockedAchievements),
            seenTimes: Array.from(seenTimes)
        };
        localStorage.setItem('zdkGameState', JSON.stringify(state));
    }

    function updatePrestigeButton() {
        const canPrestige = clickCount >= 10000;
        prestigeBtn.disabled = !canPrestige;
        if (canPrestige) {
            prestigeBtn.textContent = `‚≠ê (+${(getPrestigeMultiplier() * 0.1 * 100 + 10).toFixed(0)}%)`;
        } else {
            prestigeBtn.textContent = `‚≠ê (${clickCount}/10000)`;
        }
    }

    function checkAchievements() {
        achievements.forEach(ach => {
            if (unlockedAchievements.has(ach.id)) return;
            let unlocked = false;
            if (ach.threshold && clickCount >= ach.threshold) unlocked = true;
            else if (ach.bonusThreshold && bonusAmount >= ach.bonusThreshold) unlocked = true;
            else if (ach.timesThreshold && seenTimes.size >= ach.timesThreshold) unlocked = true;
            else if (ach.speedThreshold && buttonSpeed >= ach.speedThreshold) unlocked = true;
            else if (ach.prestigeThreshold && prestigeLevel >= ach.prestigeThreshold) unlocked = true;
            if (unlocked) unlockAchievement(ach);
        });
    }

    function unlockAchievement(achievement) {
        unlockedAchievements.add(achievement.id);
        playAchievementSound();
        showAchievementNotification(achievement);
        updateAchievementsList();
        saveGame();
    }

    function showAchievementNotification(achievement) {
        notifAchievementName.textContent = achievement.name;
        notifAchievementIcon.textContent = achievement.icon;
        achievementNotification.classList.add('show');
        setTimeout(() => achievementNotification.classList.remove('show'), 3000);
    }

    function updateAchievementsList() {
        achievementsList.innerHTML = '';
        achievements.forEach(ach => {
            const unlocked = unlockedAchievements.has(ach.id);
            const item = document.createElement('div');
            item.className = 'achievement-item' + (unlocked ? ' unlocked' : '');
            let progress = '';
            if (ach.threshold) progress = `${Math.min(clickCount, ach.threshold)}/${ach.threshold}`;
            else if (ach.bonusThreshold) progress = `${Math.min(bonusAmount, ach.bonusThreshold).toFixed(2)}/${ach.bonusThreshold} z≈Ç`;
            else if (ach.timesThreshold) progress = `${seenTimes.size}/${ach.timesThreshold}`;
            else if (ach.speedThreshold) progress = `Poziom ${buttonSpeed}/${ach.speedThreshold}`;
            else if (ach.prestigeThreshold) progress = `${prestigeLevel}/${ach.prestigeThreshold}`;
            item.innerHTML = `<div class="achievement-icon">${ach.icon}</div><div class="achievement-name">${ach.name}</div><div class="achievement-desc">${ach.desc}</div><div class="achievement-progress">${unlocked ? '‚úì Odblokowane' : progress}</div>`;
            achievementsList.appendChild(item);
        });
    }

    function updateTimeOfDay() {
        const time = timesOfDay[currentTimeIndex];
        windowEl.style.background = time.sky;
        celestial.style.background = time.celestialColor;
        celestial.style.top = time.celestialTop;
        celestial.style.boxShadow = `0 0 30px ${time.celestialColor}`;
        document.querySelector('.wall').style.background = time.wall;
        document.querySelector('.floor').style.background = time.floor;
        windowLight.style.background = `radial-gradient(ellipse at top, ${time.lightColor} ${time.lightIntensity}, transparent 70%)`;
        if (currentTimeIndex >= 5) {
            lampShade.classList.remove('off');
            lampLight.classList.remove('off');
            lampShade.style.boxShadow = '0 10px 30px rgba(255,215,0,0.4)';
        } else {
            lampShade.classList.add('off');
            lampLight.classList.add('off');
        }
        seenTimes.add(currentTimeIndex);
        checkAchievements();
    }

    function moveButton() {
        const uiRect = document.getElementById('uiContainer').getBoundingClientRect();
        const actionsRect = document.getElementById('actionButtons').getBoundingClientRect();
        const margin = 30;
        let x, y, attempts = 0;
        do {
            x = Math.random() * (window.innerWidth - button.offsetWidth - margin * 2) + margin;
            y = Math.random() * (window.innerHeight - button.offsetHeight - margin * 2) + margin;
            const collidesUI = x < uiRect.right + margin * 2 && x + button.offsetWidth > uiRect.left - margin && y < uiRect.bottom + margin * 2 && y + button.offsetHeight > uiRect.top - margin;
            const collidesActions = x < actionsRect.right + margin * 2 && x + button.offsetWidth > actionsRect.left - margin * 2 && y < actionsRect.bottom + margin * 2 && y + button.offsetHeight > actionsRect.top - margin * 2;
            if (!collidesUI && !collidesActions) break;
        } while (++attempts < 100);
        button.style.transition = `all ${Math.max(0.1, 0.5 - (buttonSpeed - 1) * 0.04)}s ease`;
        button.style.left = x + 'px';
        button.style.top = y + 'px';
        button.style.transform = '';
    }

    button.addEventListener('click', () => {
        clickCount++;
        countDisplay.textContent = clickCount;
        playClickSound();
        moveButton();

        if (clickCount % 100 === 0) {
            const bonusWithPrestige = 2.09 * getPrestigeMultiplier();
            bonusAmount += bonusWithPrestige;
            bonusDisplay.textContent = bonusAmount.toFixed(2);
            buttonSpeed++;

            const bonusBox = document.querySelector('.ui-box.bonus');
            bonusBox.style.transform = 'scale(1.1)';
            setTimeout(() => bonusBox.style.transform = 'scale(1)', 200);

            if (buttonSpeed <= 15) {
                const speedNotif = document.createElement('div');
                speedNotif.style.cssText = 'position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(255,107,107,0.95);color:white;padding:20px 40px;border-radius:15px;font-size:24px;font-weight:bold;z-index:1500;border:4px solid white;box-shadow:0 10px 40px rgba(0,0,0,0.5)';
                speedNotif.textContent = `‚ö° Poziom ${buttonSpeed}! Przycisk szybszy!`;
                document.body.appendChild(speedNotif);
                setTimeout(() => {
                    speedNotif.style.transition = 'opacity 0.5s';
                    speedNotif.style.opacity = '0';
                    setTimeout(() => speedNotif.remove(), 500);
                }, 1500);
            }
        }

        if (clickCount % 20 === 0) {
            currentTimeIndex = (currentTimeIndex + 1) % timesOfDay.length;
            updateTimeOfDay();
        }

        checkAchievements();
        updatePrestigeButton();
        saveGame();
    });

    withdrawBtn.addEventListener('click', () => {
        if (bonusAmount === 0) {
            modalTitle.textContent = 'üí∏ Brak premii';
            modalText.textContent = 'Jeszcze za ma≈Ço klikniƒôƒá! Pracuj dalej, aby uzbieraƒá premiƒô.';
        } else {
            const taxes = [
                { name: 'PIT', amount: bonusAmount * 0.32 },
                { name: 'ZUS', amount: bonusAmount * 0.28 },
                { name: 'NFZ', amount: bonusAmount * 0.09 },
                { name: 'Sk≈Çadka zdrowotna', amount: bonusAmount * 0.12 },
                { name: 'Podatek od premii', amount: bonusAmount * 0.19 }
            ];
            const totalTax = taxes.reduce((sum, tax) => sum + tax.amount, 0);
            const remaining = bonusAmount - totalTax;

            modalTitle.textContent = 'üí∞ Wyp≈Çata premii';
            modalText.innerHTML = `<strong>Twoja premia: ${bonusAmount.toFixed(2)} z≈Ç</strong><br><br>ObowiƒÖzkowe odliczenia:<br>${taxes.map(tax => `‚Ä¢ ${tax.name}: -${tax.amount.toFixed(2)} z≈Ç`).join('<br>')}<br><br><strong style="color: #ff6b6b; font-size: 24px;">Do wyp≈Çaty: ${Math.max(0, remaining).toFixed(2)} z≈Ç</strong><br><br>${remaining <= 0 ? `<span style="opacity: 0.7; font-size: 14px;">Niestety podatki poch≈Çonƒô≈Çy ca≈ÇƒÖ premiƒô...</span><br><br><button id="buyTaxRelief" style="margin-top:15px;padding:15px 30px;font-size:16px;background:linear-gradient(135deg,#10b981,#059669);color:white;border:3px solid #047857;border-radius:10px;cursor:pointer;font-family:inherit;font-weight:bold;box-shadow:0 4px 15px rgba(16,185,129,0.4)">üí≥ Kup ulgƒô podatkowƒÖ (3000 z≈Ç)</button>` : '<span style="color:#00ff88">Gratulacje! Uda≈Ço Ci siƒô co≈õ zachowaƒá!</span>'}`;

            const buyBtn = document.getElementById('buyTaxRelief');
            if (buyBtn) {
                buyBtn.addEventListener('click', () => {
                    showPaymentForm();
                });
            }

            if (remaining <= 0) {
                bonusAmount = 0;
                bonusDisplay.textContent = '0.00';
                saveGame();
            }
        }
        modal.classList.add('show');
    });

    function showPaymentForm() {
        modalTitle.textContent = 'üí≥ P≈Çatno≈õƒá - Ulga podatkowa';
        modalText.innerHTML = `
            <div style="text-align:left;max-width:400px;margin:0 auto">
                <p style="margin-bottom:20px;text-align:center">Kwota do zap≈Çaty: <strong style="color:#00ff88">3000.00 z≈Ç</strong></p>

                <label style="display:block;margin-bottom:5px;font-size:14px">Numer karty:</label>
                <input type="text" id="cardNumber" placeholder="1234 5678 9012 3456" maxlength="19" style="width:100%;padding:12px;margin-bottom:15px;background:#2d3748;color:white;border:2px solid #667eea;border-radius:8px;font-family:inherit;font-size:16px">

                <div style="display:grid;grid-template-columns:1fr 1fr;gap:15px;margin-bottom:15px">
                    <div>
                        <label style="display:block;margin-bottom:5px;font-size:14px">Data wa≈ºno≈õci:</label>
                        <input type="text" id="cardExpiry" placeholder="MM/RR" maxlength="5" style="width:100%;padding:12px;background:#2d3748;color:white;border:2px solid #667eea;border-radius:8px;font-family:inherit;font-size:16px">
                    </div>
                    <div>
                        <label style="display:block;margin-bottom:5px;font-size:14px">CVV:</label>
                        <input type="text" id="cardCVV" placeholder="123" maxlength="3" style="width:100%;padding:12px;background:#2d3748;color:white;border:2px solid #667eea;border-radius:8px;font-family:inherit;font-size:16px">
                    </div>
                </div>

                <label style="display:block;margin-bottom:5px;font-size:14px">Imiƒô i nazwisko:</label>
                <input type="text" id="cardName" placeholder="Jan Kowalski" style="width:100%;padding:12px;margin-bottom:20px;background:#2d3748;color:white;border:2px solid #667eea;border-radius:8px;font-family:inherit;font-size:16px">

                <button id="confirmPayment" style="width:100%;padding:15px;font-size:18px;background:#10b981;color:white;border:3px solid #047857;border-radius:10px;cursor:pointer;font-family:inherit;font-weight:bold;margin-bottom:10px">‚úì Zap≈Çaƒá 3000 z≈Ç</button>
                <button id="cancelPayment" style="width:100%;padding:12px;font-size:16px;background:#ff6b6b;color:white;border:3px solid #c92a2a;border-radius:10px;cursor:pointer;font-family:inherit">‚úó Anuluj</button>

                <p style="margin-top:15px;font-size:12px;opacity:0.7;text-align:center">üîí Bezpieczna p≈Çatno≈õƒá SSL 256-bit</p>
            </div>
        `;

        // Auto-format card number
        const cardNumberInput = document.getElementById('cardNumber');
        cardNumberInput.addEventListener('input', (e) => {
            let value = e.target.value.replace(/\s/g, '');
            let formattedValue = value.match(/.{1,4}/g)?.join(' ') || value;
            e.target.value = formattedValue;
        });

        // Auto-format expiry
        const expiryInput = document.getElementById('cardExpiry');
        expiryInput.addEventListener('input', (e) => {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length >= 2) {
                value = value.slice(0,2) + '/' + value.slice(2,4);
            }
            e.target.value = value;
        });

        document.getElementById('confirmPayment').addEventListener('click', () => {
            const cardNumber = document.getElementById('cardNumber').value;
            const cardExpiry = document.getElementById('cardExpiry').value;
            const cardCVV = document.getElementById('cardCVV').value;
            const cardName = document.getElementById('cardName').value;

            if (!cardNumber || !cardExpiry || !cardCVV || !cardName) {
                alert('Wype≈Çnij wszystkie pola!');
                return;
            }

            // "Przetwarzanie"
            modalTitle.textContent = '‚è≥ Przetwarzanie p≈Çatno≈õci...';
            modalText.innerHTML = '<div style="text-align:center;padding:40px"><div style="font-size:48px;margin-bottom:20px">‚è≥</div><p>≈ÅƒÖczymy z bankiem...</p></div>';

            setTimeout(() => {
                // TROLLING!
                modalTitle.textContent = '‚ùå B≈ÇƒÖd p≈Çatno≈õci';
                modalText.innerHTML = `
                    <div style="text-align:center;padding:20px">
                        <div style="font-size:64px;margin-bottom:20px">üòÖ</div>
                        <p style="font-size:18px;margin-bottom:15px"><strong>Przepraszamy!</strong></p>
                        <p style="margin-bottom:20px">WystƒÖpi≈Ç nieoczekiwany b≈ÇƒÖd podczas przetwarzania p≈Çatno≈õci.</p>
                        <p style="opacity:0.8;font-size:14px;margin-bottom:10px"><em>Kod b≈Çƒôdu: TAX_EVASION_IMPOSSIBLE</em></p>
                        <p style="opacity:0.7;font-size:13px">Podatki w Polsce sƒÖ nieuniknione. Witaj w rzeczywisto≈õci! üáµüá±</p>
                    </div>
                `;
            }, 2000);
        });

        document.getElementById('cancelPayment').addEventListener('click', () => {
            modal.classList.remove('show');
        });
    }

    shareBtn.addEventListener('click', () => {
        const playerInfo = playerName ? `üë§ Gracz: ${playerName}\n` : '';
        const text = `üéÆ Klikam wiƒôc jestem\n\n${playerInfo}üíº Klikniƒôcia: ${clickCount}\nüí∞ Premia: ${bonusAmount.toFixed(2)} z≈Ç\n‚≠ê Prestige: ${prestigeLevel}\nüèÜ OsiƒÖgniƒôcia: ${unlockedAchievements.size}/${achievements.length}\n\nSpr√≥buj sam!`;
        if (navigator.share) {
            navigator.share({ title: 'Klikam wiƒôc jestem', text: text }).catch(() => {});
        } else {
            navigator.clipboard.writeText(text).then(() => {
                modalTitle.textContent = 'üìã Skopiowano!';
                modalText.textContent = 'Wynik zosta≈Ç skopiowany do schowka!';
                modal.classList.add('show');
            }).catch(() => {
                modalTitle.textContent = 'üì§ Tw√≥j wynik';
                modalText.innerHTML = `<textarea readonly style="width:100%;padding:10px;margin:10px 0;background:#2d3748;color:white;border:2px solid #667eea;border-radius:8px;font-family:inherit">${text}</textarea>`;
                modal.classList.add('show');
            });
        }
    });

    prestigeBtn.addEventListener('click', () => {
        if (clickCount >= 10000) {
            modalTitle.textContent = '‚≠ê Prestige';
            modalText.innerHTML = '<strong>Czy na pewno chcesz wykonaƒá Prestige?</strong><br><br>Reset:<br>‚Ä¢ Klikniƒôcia: 0<br>‚Ä¢ Premia: 0 z≈Ç<br>‚Ä¢ Szybko≈õƒá: 1<br><br>Zachowasz:<br>‚Ä¢ OsiƒÖgniƒôcia<br>‚Ä¢ Poziom Prestige +1<br><br><strong style="color:#00ff88">Bonus: +10% premii na zawsze!</strong><br><br><button id="confirmPrestige" style="margin:10px;padding:15px 30px;font-size:18px;background:#667eea;color:white;border:3px solid #4a5fbb;border-radius:10px;cursor:pointer;font-family:inherit;font-weight:bold">‚úì Tak!</button><button id="cancelPrestige" style="margin:10px;padding:15px 30px;font-size:18px;background:#ff6b6b;color:white;border:3px solid #c92a2a;border-radius:10px;cursor:pointer;font-family:inherit;font-weight:bold">‚úó Anuluj</button>';
            modal.classList.add('show');
            document.getElementById('confirmPrestige').addEventListener('click', () => {
                prestigeLevel++;
                prestigeDisplay.textContent = prestigeLevel;
                clickCount = bonusAmount = buttonSpeed = 0;
                currentTimeIndex = 0;
                countDisplay.textContent = '0';
                bonusDisplay.textContent = '0.00';
                updateTimeOfDay();
                checkAchievements();
                updatePrestigeButton();
                saveGame();
                modal.classList.remove('show');
                playAchievementSound();
                showAchievementNotification({ name: `Prestige ${prestigeLevel}!`, icon: '‚≠ê' });
            });
            document.getElementById('cancelPrestige').addEventListener('click', () => modal.classList.remove('show'));
        }
    });

    achievementsBtn.addEventListener('click', () => achievementsPanel.classList.add('open'));
    closeAchievements.addEventListener('click', () => achievementsPanel.classList.remove('open'));

    helpBtn.addEventListener('click', () => {
        modalTitle.textContent = 'üìñ Jak graƒá?';
        modalText.innerHTML = `<div style="text-align:left;line-height:1.8"><strong style="color:#00ff88;font-size:20px">üéØ Cel gry:</strong><br>Klikaj przycisk ZDK, rozwijaj firmƒô i siebie! Zbieraj premie i awansuj przez system Prestige.<br><br><strong style="color:#ffd700;font-size:18px">üí∞ System premii:</strong><br>‚Ä¢ Co 100 klikniƒôƒá = 2.09 z≈Ç premii<br>‚Ä¢ Mo≈ºesz wyp≈Çacaƒá zebrane ≈õrodki<br>‚Ä¢ Bonus ro≈õnie z poziomem Prestige<br><br><strong style="color:#667eea;font-size:18px">‚≠ê Prestige - co to?</strong><br>Prestige to reset postƒôpu za permanentne bonusy!<br><br>‚Ä¢ Odblokowanie: 10,000 klikniƒôƒá<br>‚Ä¢ Reset: klikniƒôcia ‚Üí 0, premia ‚Üí 0<br>‚Ä¢ Zachowujesz: osiƒÖgniƒôcia, poziom Prestige<br>‚Ä¢ <span style="color:#00ff88">Bonus: +10% premii NA ZAWSZE!</span><br>‚Ä¢ Przyk≈Çad: Prestige 5 = dostajesz 150% premii<br><br><strong style="color:#f093fb;font-size:18px">üèÜ OsiƒÖgniƒôcia (17):</strong><br>‚Ä¢ Odblokowuj za klikniƒôcia i premie<br>‚Ä¢ Zobacz pe≈ÇnƒÖ listƒô w panelu<br><br><strong style="color:#ff6b6b;font-size:18px">‚ö° Mechanika trudno≈õci:</strong><br>‚Ä¢ Co 100 klikniƒôƒá przycisk staje siƒô szybszy<br>‚Ä¢ Im wy≈ºszy poziom, tym wiƒôksze wyzwanie!<br><br><span style="opacity:0.7;font-size:14px">üíæ Gra zapisuje siƒô automatycznie co 5 sekund</span></div>`;
        modal.classList.add('show');
    });

    modalClose.addEventListener('click', () => modal.classList.remove('show'));
    modal.addEventListener('click', e => { if (e.target === modal) modal.classList.remove('show'); });

    startButton.addEventListener('click', () => {
        // Zapisz imiƒô gracza
        const nameValue = playerNameInput.value.trim();
        if (nameValue) {
            playerName = nameValue;
            saveGame();
        }

        titleScreen.classList.add('hidden');
        setTimeout(() => titleScreen.style.display = 'none', 500);
        moveButton();
        updateTimeOfDay();
    });

    window.addEventListener('resize', () => { if (!titleScreen.classList.contains('hidden')) return; moveButton(); });

    loadGame();
    updateTimeOfDay();
    updateAchievementsList();
    setInterval(saveGame, 5000);
</script>
</body>
</html>